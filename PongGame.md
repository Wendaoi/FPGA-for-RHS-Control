# PongGame实验规则与信号输入输出方法详解

## 游戏基本规则

1. **游戏目标**：神经元电极控制的"球拍"(paddle)需要拦截移动的"球"(ball)，尽可能延长每次回合(rally)的持续时间。

2. **游戏区域**：
   - 球在虚拟游戏区域内以固定速度移动
   - 球拍只能在画面左侧边缘上下移动，用于拦截球。其余三个方向边缘没有球拍，当球产生碰撞时反弹。
   - 球会从游戏区域的边缘和球拍上"反弹"
   - 当球击中球拍后面的边缘时，标志着一个rally(回合)结束

3. **得分机制**：
   - 每个rally的得分(score)等于球被球拍成功拦截的次数（"bounces"）
   - 文中公式：`scorei` = 该rally中球被拦截的次数
   - 性能主要通过"average rally length"（平均回合长度）来衡量

4. **回合结束条件**：
   - 当球击中球拍后面的边缘（未被拦截）时，当前rally结束
   - 结束后，系统会根据实验条件提供不同类型的反馈，然后开始新的rally

## 信号输入方法（刺激系统）

1. **感觉输入系统**：
   - 使用8个感觉电极(sensory electrodes)向神经元提供刺激
   - 球相对于球拍的位置被编码为对这8个刺激位点之一的刺激
   - 电极排列方式允许粗略但拓扑一致的位置编码（topographically consistent place coding）
   - 刺激形式：短的双相方波脉冲（先正电压，后负电压）

2. **刺激时序**：
   - 刺激序列器每秒更新20,000次（每收到一个MEA样本就更新一次）
   - 位置信息每10毫秒更新一次，与游戏更新频率同步

3. **不同情境下的刺激反馈**：
   - **成功拦截(hit)**：提供可预测刺激(predictable stimulation)
     - 所有电极同时以100Hz频率进行100ms的短暂刺激
     - 短暂中断常规感觉刺激，然后游戏继续有规律地进行
   - **未成功拦截(miss)**：提供不可预测刺激(unpredictable stimulation)
     - 150mV电压以5Hz频率持续4秒
     - 之后球以随机向量重新开始运动
   - **Silent条件**：miss后所有刺激暂停一段时间，然后游戏以随机方向重新开始
   - **No-feedback条件**：miss后球继续弹跳而不中断，位置刺激仍提供



## 信号输出方法（神经元响应）

1. **运动控制系统**：
   - 神经元活动通过高密度多电极阵列(HD-MEA)记录
   - 活动被分为两个运动区域(motor regions)：（）
     - Motor Region 1：活动使球拍"向上"移动
     - Motor Region 2：活动使球拍"向下"移动

2. **信号处理流程**：
   - 每10毫秒（200个样本）对运动区域中检测到的尖峰(spikes)进行计数
   - 将这些尖峰计数解释为运动活动，根据尖峰发生的运动区域
   - 活动较高的区域将使球拍向相应方向移动
   - 系统对噪声水平以下的活动(<-5mV)不予考虑


## 多种实验条件对比（都需实现，单次运行时可以通过参数选择）

1. **Stimulus条件**：
   - 可预测刺激用于成功拦截，不可预测刺激用于未成功拦截
   - 代表完整的闭环反馈系统

2. **Silent条件**：
   - 用一段所有刺激都被暂停的时间替换刺激反馈
   - 之后游戏以随机方向重新开始

3. **No-feedback条件**：
   - 移除错过后的重新开始机制
   - 当球拍未成功拦截球时，球继续弹跳而不中断
   - 位置刺激仍提供，但没有额外反馈

4. **Rest条件**：
   - 活动培养物控制球拍但不接收感觉信息
   - 用于性能归一化

## 性能评估指标

1. **主要指标**：
   - 平均rally长度(average rally length)：衡量学习效果的主要指标

2. **辅助指标**：
   - "aces"：没有单次击中就未能拦截球的次数
   - "long rallies"：具有大于3次连续击中的游戏次数

## 技术实现细节

1. **采样与更新频率**：
   - 电生理数据采样率：20,000 Hz
   - 游戏更新频率：100 Hz（每10毫秒更新一次）
   - 尖峰计数时间窗口：10毫秒

2. **数据流**：
   - 电压样本从MEA流向"Pong"环境
   - 感觉信息流回MEA，形成闭环
   - 每10毫秒，游戏环境接收配置电极中检测到的尖峰数量

